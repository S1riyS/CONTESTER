{% import 'macros/all_macros.html' as macros %}

<div class="table__wrapper">
    {% if submissions %}
        <div class="table box-shadow">
            <div class="table_header__wrapper">
                <div class="table_header">
                    {# Students #}
                    {% if show_users %}
                        <div class="table_header_column students">
                            <p>УЧЕНИКИ</p>
                        </div>
                    {% endif %}
                    {# Result #}
                    <div class="table_header_column result">
                        <p>РЕЗУЛЬТАТ</p>
                    </div>
                    {# Task #}
                    {% if show_task %}
                        <div class="table_header_column task">
                            <p>ЗАДАЧА</p>
                        </div>
                    {% endif %}
                    {# Language #}
                    <div class="table_header_column language">
                        <p>ЯЗЫК</p>
                    </div>
                    {# Time #}
                    <div class="table_header_column time">
                        <p>ВРЕМЯ</p>
                    </div>
                    {# View result #}
                    <div class="table_header_column view_result"></div>
                </div>
            </div>

            <div class="table_body">
                {% for submission in submissions %}
                    <div class="table_row__wrapper">
                        <div class="table_row">
                            {# Students #}
                            {% if show_users %}
                                <div class="table_row_column students">
                                    {{ macros.render_submission_owners(submission) }}
                                </div>
                            {% endif %}

                            {# Result #}
                            <div class="table_row_column result">
                                {{ macros.render_submission_result(submission, show_passed_tests=True) }}
                            </div>

                            {# Task #}
                            {% if show_task %}
                                <div class="table_row_column task">
                                    {% set task = submission.task %}
                                    <a href="{{ get_task_url(task) }}" class="default_link">
                                        {{ task.name }}
                                    </a>
                                </div>
                            {% endif %}

                            {# Language #}
                            <div class="table_row_column language">
                                {% set language = languages.get_language(submission.language)['language'] %}
                                <img src="{{ language.icon_url }}" alt="Language icon" class="language__icon">
                                <p class="language__name">{{ language.fullname }}</p>
                            </div>

                            {# Time #}
                            <div class="table_row_column time">
                                {{ moment(submission.submission_date).fromNow(refresh=True) }}
                            </div>

                            {# View result #}
                            <div class="table_row_column view_result">
                                <a class="view_result__link default_link" target="_blank"
                                   href="{{ url_for('submission_page', submission_id=submission.id) }}">
                                    Подробнее
                                </a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% else %}
        {% include 'responses/empty_response.html' %}
    {% endif %}
</div>
